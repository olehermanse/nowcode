{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","getBufferID","pathname","window","location","substr","updateServer","xhr","XMLHttpRequest","url","content","document","getElementById","value","open","setRequestHeader","onreadystatechange","readyState","status","JSON","parse","responseText","data","stringify","buffer_id","send","synchronize","console","log","responseType","onload","hasChangedSinceGet","response","setTimeout","host","editorCode","addEventListener"],"mappings":"CAAA,SAAUA,EAAEC,EAAEC,EAAEC,GAAG,SAASC,EAAEC,EAAEC,GAAG,IAAIJ,EAAEG,GAAG,CAAC,IAAIJ,EAAEI,GAAG,CAAC,IAAIE,EAAkB,mBAATC,SAAqBA,QAAQ,IAAIF,GAAGC,EAAE,OAAOA,EAAEF,GAAE,GAAI,GAAGI,EAAE,OAAOA,EAAEJ,GAAE,GAAI,IAAIK,EAAE,IAAIC,MAAM,uBAAuBN,EAAE,KAAK,MAAMK,EAAEE,KAAK,mBAAmBF,EAAE,IAAIG,EAAEX,EAAEG,IAAIS,YAAYb,EAAEI,GAAG,GAAGU,KAAKF,EAAEC,QAAQ,SAASd,GAAG,IAAIE,EAAED,EAAEI,GAAG,GAAGL,GAAG,OAAOI,EAAEF,GAAIF,IAAIa,EAAEA,EAAEC,QAAQd,EAAEC,EAAEC,EAAEC,GAAG,OAAOD,EAAEG,GAAGS,QAAkD,IAAI,IAA1CL,EAAkB,mBAATD,SAAqBA,QAAgBH,EAAE,EAAEA,EAAEF,EAAEa,OAAOX,IAAID,EAAED,EAAEE,IAAI,OAAOD,EAAvb,EAA4ba,GAAG,SAAST,EAAQU,EAAOJ,GACvd,cAEA,WAqBE,SAASK,IACP,IAAIC,EAAWC,OAAOC,SAASF,SAE/B,OADeA,EAASG,OAAO,EAAGH,EAASJ,OAAS,GAItD,SAASQ,IACP,IAAIC,EAAM,IAAIC,eACVC,EAAM,gBAAkBR,IAExBS,EADaC,SAASC,eAAe,cAChBC,MAEzBN,EAAIO,KAAK,OAAQL,GAAK,GACtBF,EAAIQ,iBAAiB,eAAgB,oBACrCR,EAAIS,mBAAqB,WACvB,GAAuB,IAAnBT,EAAIU,YAAmC,MAAfV,EAAIW,OACnBC,KAAKC,MAAMb,EAAIc,eAG9B,IAAIC,EAAOH,KAAKI,WACdb,QAAWA,EACXc,UAAavB,MAEfM,EAAIkB,KAAKH,GAGX,SAASI,IACPC,QAAQC,IAAI,eACZ,IAAInB,EAAM,gBAAkBR,IACxBM,EAAM,IAAIC,eACdD,EAAIO,KAAK,MAAOL,GAAK,GACrBF,EAAIsB,aAAe,OACnBtB,EAAIuB,OAAS,WAEI,MADFvB,EAAIW,QAC2B,GAAtBa,EACHpB,SAASC,eAAe,cAC9BC,MAAQN,EAAIyB,SAAkB,QAEzCL,QAAQC,IAAI,0BAEdK,WAAWP,EAAa,MAE1BnB,EAAIkB,OACJM,GAAqB,EA/DPpB,SAASC,eAAe,aAC9BC,MAAQV,OAAOC,SAAS8B,KAAO/B,OAAOC,SAASF,SAEzD,IAAIiC,EAAaxB,SAASC,eAAe,cACrCmB,GAAqB,EACzBI,EAAWC,iBAAiB,QAAS,WACnCL,GAAqB,EACrBzB,MAGF6B,EAAWC,iBAAiB,QAAS,WACnCL,GAAqB,EACrBzB,MAGF6B,EAAWC,iBAAiB,SAAU,WACpCL,GAAqB,EACrBzB,MAgDFoB,IAlEF,aAqEW","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n(function () {\n  var shareLink = document.getElementById('shareLink');\n  shareLink.value = window.location.host + window.location.pathname;\n\n  var editorCode = document.getElementById('editorCode');\n  var hasChangedSinceGet = false;\n  editorCode.addEventListener(\"input\", function () {\n    hasChangedSinceGet = true;\n    updateServer();\n  });\n\n  editorCode.addEventListener(\"keyup\", function () {\n    hasChangedSinceGet = true;\n    updateServer();\n  });\n\n  editorCode.addEventListener(\"change\", function () {\n    hasChangedSinceGet = true;\n    updateServer();\n  });\n\n  function getBufferID() {\n    var pathname = window.location.pathname;\n    var bufferID = pathname.substr(1, pathname.length - 1);\n    return bufferID;\n  }\n\n  function updateServer() {\n    var xhr = new XMLHttpRequest();\n    var url = '/api/buffers/' + getBufferID();\n    var editorCode = document.getElementById('editorCode');\n    var content = editorCode.value;\n\n    xhr.open(\"POST\", url, true);\n    xhr.setRequestHeader(\"Content-type\", \"application/json\");\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === 4 && xhr.status === 200) {\n        var json = JSON.parse(xhr.responseText);\n      }\n    };\n    var data = JSON.stringify({\n      \"content\": content,\n      \"buffer_id\": getBufferID()\n    });\n    xhr.send(data);\n  }\n\n  function synchronize() {\n    console.log(\"synchronize\");\n    var url = '/api/buffers/' + getBufferID();\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', url, true);\n    xhr.responseType = 'json';\n    xhr.onload = function () {\n      var status = xhr.status;\n      if (status === 200 && hasChangedSinceGet == false) {\n        var editorCode = document.getElementById('editorCode');\n        editorCode.value = xhr.response[\"content\"];\n      } else {\n        console.log('Failed synchronization');\n      }\n      setTimeout(synchronize, 150);\n    };\n    xhr.send();\n    hasChangedSinceGet = false;\n  }\n  synchronize();\n})();\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2NyaXB0cy9tYWluLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSxDQUFDLFlBQVU7QUFDVCxNQUFJLFlBQVksU0FBUyxjQUFULENBQXdCLFdBQXhCLENBQWhCO0FBQ0EsWUFBVSxLQUFWLEdBQWtCLE9BQU8sUUFBUCxDQUFnQixJQUFoQixHQUF1QixPQUFPLFFBQVAsQ0FBZ0IsUUFBekQ7O0FBRUEsTUFBSSxhQUFhLFNBQVMsY0FBVCxDQUF3QixZQUF4QixDQUFqQjtBQUNBLE1BQUkscUJBQXFCLEtBQXpCO0FBQ0EsYUFBVyxnQkFBWCxDQUE0QixPQUE1QixFQUFxQyxZQUFXO0FBQzlDLHlCQUFxQixJQUFyQjtBQUNBO0FBQ0QsR0FIRDs7QUFLQSxhQUFXLGdCQUFYLENBQTRCLE9BQTVCLEVBQXFDLFlBQVc7QUFDOUMseUJBQXFCLElBQXJCO0FBQ0E7QUFDRCxHQUhEOztBQUtBLGFBQVcsZ0JBQVgsQ0FBNEIsUUFBNUIsRUFBc0MsWUFBVztBQUMvQyx5QkFBcUIsSUFBckI7QUFDQTtBQUNELEdBSEQ7O0FBS0EsV0FBUyxXQUFULEdBQXVCO0FBQ3JCLFFBQUksV0FBVyxPQUFPLFFBQVAsQ0FBZ0IsUUFBL0I7QUFDQSxRQUFJLFdBQVcsU0FBUyxNQUFULENBQWdCLENBQWhCLEVBQW1CLFNBQVMsTUFBVCxHQUFpQixDQUFwQyxDQUFmO0FBQ0EsV0FBTyxRQUFQO0FBQ0Q7O0FBRUQsV0FBUyxZQUFULEdBQXdCO0FBQ3RCLFFBQUksTUFBTSxJQUFJLGNBQUosRUFBVjtBQUNBLFFBQUksTUFBTSxrQkFBa0IsYUFBNUI7QUFDQSxRQUFJLGFBQWEsU0FBUyxjQUFULENBQXdCLFlBQXhCLENBQWpCO0FBQ0EsUUFBSSxVQUFVLFdBQVcsS0FBekI7O0FBRUEsUUFBSSxJQUFKLENBQVMsTUFBVCxFQUFpQixHQUFqQixFQUFzQixJQUF0QjtBQUNBLFFBQUksZ0JBQUosQ0FBcUIsY0FBckIsRUFBcUMsa0JBQXJDO0FBQ0EsUUFBSSxrQkFBSixHQUF5QixZQUFZO0FBQ25DLFVBQUksSUFBSSxVQUFKLEtBQW1CLENBQW5CLElBQXdCLElBQUksTUFBSixLQUFlLEdBQTNDLEVBQWdEO0FBQzlDLFlBQUksT0FBTyxLQUFLLEtBQUwsQ0FBVyxJQUFJLFlBQWYsQ0FBWDtBQUNEO0FBQ0YsS0FKRDtBQUtBLFFBQUksT0FBTyxLQUFLLFNBQUwsQ0FBZTtBQUN4QixpQkFBVyxPQURhO0FBRXhCLG1CQUFhO0FBRlcsS0FBZixDQUFYO0FBSUEsUUFBSSxJQUFKLENBQVMsSUFBVDtBQUNEOztBQUVELFdBQVMsV0FBVCxHQUF1QjtBQUNyQixZQUFRLEdBQVIsQ0FBWSxhQUFaO0FBQ0EsUUFBSSxNQUFNLGtCQUFrQixhQUE1QjtBQUNBLFFBQUksTUFBTSxJQUFJLGNBQUosRUFBVjtBQUNBLFFBQUksSUFBSixDQUFTLEtBQVQsRUFBZ0IsR0FBaEIsRUFBcUIsSUFBckI7QUFDRSxRQUFJLFlBQUosR0FBbUIsTUFBbkI7QUFDQSxRQUFJLE1BQUosR0FBYSxZQUFXO0FBQ3RCLFVBQUksU0FBUyxJQUFJLE1BQWpCO0FBQ0EsVUFBSSxXQUFXLEdBQVgsSUFBa0Isc0JBQXNCLEtBQTVDLEVBQW1EO0FBQ2pELFlBQUksYUFBYSxTQUFTLGNBQVQsQ0FBd0IsWUFBeEIsQ0FBakI7QUFDQSxtQkFBVyxLQUFYLEdBQW1CLElBQUksUUFBSixDQUFhLFNBQWIsQ0FBbkI7QUFDRCxPQUhELE1BR087QUFDTCxnQkFBUSxHQUFSLENBQVksd0JBQVo7QUFDRDtBQUNELGlCQUFXLFdBQVgsRUFBd0IsR0FBeEI7QUFDRCxLQVREO0FBVUYsUUFBSSxJQUFKO0FBQ0EseUJBQXFCLEtBQXJCO0FBQ0Q7QUFDRDtBQUVELENBcEVEIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIihmdW5jdGlvbigpe1xuICB2YXIgc2hhcmVMaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoYXJlTGluaycpO1xuICBzaGFyZUxpbmsudmFsdWUgPSB3aW5kb3cubG9jYXRpb24uaG9zdCArIHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZVxuXG4gIHZhciBlZGl0b3JDb2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VkaXRvckNvZGUnKTtcbiAgdmFyIGhhc0NoYW5nZWRTaW5jZUdldCA9IGZhbHNlO1xuICBlZGl0b3JDb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbigpIHtcbiAgICBoYXNDaGFuZ2VkU2luY2VHZXQgPSB0cnVlO1xuICAgIHVwZGF0ZVNlcnZlcigpO1xuICB9KTtcblxuICBlZGl0b3JDb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBmdW5jdGlvbigpIHtcbiAgICBoYXNDaGFuZ2VkU2luY2VHZXQgPSB0cnVlO1xuICAgIHVwZGF0ZVNlcnZlcigpO1xuICB9KTtcblxuICBlZGl0b3JDb2RlLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgZnVuY3Rpb24oKSB7XG4gICAgaGFzQ2hhbmdlZFNpbmNlR2V0ID0gdHJ1ZTtcbiAgICB1cGRhdGVTZXJ2ZXIoKTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gZ2V0QnVmZmVySUQoKSB7XG4gICAgdmFyIHBhdGhuYW1lID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuICAgIHZhciBidWZmZXJJRCA9IHBhdGhuYW1lLnN1YnN0cigxLCBwYXRobmFtZS5sZW5ndGggLTEpO1xuICAgIHJldHVybiBidWZmZXJJRDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZVNlcnZlcigpIHtcbiAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgdmFyIHVybCA9ICcvYXBpL2J1ZmZlcnMvJyArIGdldEJ1ZmZlcklEKCk7XG4gICAgdmFyIGVkaXRvckNvZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZWRpdG9yQ29kZScpO1xuICAgIHZhciBjb250ZW50ID0gZWRpdG9yQ29kZS52YWx1ZTtcblxuICAgIHhoci5vcGVuKFwiUE9TVFwiLCB1cmwsIHRydWUpO1xuICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC10eXBlXCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSA0ICYmIHhoci5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIFwiY29udGVudFwiOiBjb250ZW50LFxuICAgICAgXCJidWZmZXJfaWRcIjogZ2V0QnVmZmVySUQoKSxcbiAgICB9KTtcbiAgICB4aHIuc2VuZChkYXRhKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHN5bmNocm9uaXplKCkge1xuICAgIGNvbnNvbGUubG9nKFwic3luY2hyb25pemVcIik7XG4gICAgdmFyIHVybCA9ICcvYXBpL2J1ZmZlcnMvJyArIGdldEJ1ZmZlcklEKCk7XG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHhoci5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YXR1cyA9IHhoci5zdGF0dXM7XG4gICAgICAgIGlmIChzdGF0dXMgPT09IDIwMCAmJiBoYXNDaGFuZ2VkU2luY2VHZXQgPT0gZmFsc2UpIHtcbiAgICAgICAgICB2YXIgZWRpdG9yQ29kZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdlZGl0b3JDb2RlJyk7XG4gICAgICAgICAgZWRpdG9yQ29kZS52YWx1ZSA9IHhoci5yZXNwb25zZVtcImNvbnRlbnRcIl1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRmFpbGVkIHN5bmNocm9uaXphdGlvbicpO1xuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoc3luY2hyb25pemUsIDE1MCk7XG4gICAgICB9O1xuICAgIHhoci5zZW5kKCk7XG4gICAgaGFzQ2hhbmdlZFNpbmNlR2V0ID0gZmFsc2U7XG4gIH1cbiAgc3luY2hyb25pemUoKTtcblxufSkoKTtcbiJdfQ==\n"]}